@startuml ATM_Cash_Retrieval_Activity

start

:Insert Card;
:Enter PIN;
:ATM.validatePIN();

if ("Valid PIN?") then (yes)
    :Select Transaction;
    if ("Withdraw Cash?") then (yes)
        :Enter Amount;
        :ATM.validateFunds();
        if ("Sufficient Funds?") then (yes)
            :ATM.dispenseCash();
            :Account.updateBalance();
            :ATM.printReceipt();
            :Eject Card;
            stop
        else (no)
            :Display Insufficient Funds;
            :Eject Card;
            stop
        endif
    else (no)
        :Redirect to Other Transactions;
        stop
    endif
else (no)
    :Notify Invalid PIN;
    :Retry PIN;
    if ("Max Retries Exceeded?") then (yes)
        :Retain Card;
        stop
    else (retry)
        -> [back to] :ATM.validatePIN();
    endif
endif

@enduml